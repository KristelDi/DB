DROP TABLE IF EXISTS Followers;
DROP TABLE IF EXISTS Threads;
DROP TABLE IF EXISTS Forums;
DROP TABLE IF EXISTS Posts;
DROP TABLE IF EXISTS Users;

CREATE TABLE Users (
    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    email VARCHAR(50) NOT NULL,
    username VARCHAR(50),
    about TEXT,
    name VARCHAR(50),
    isAnonymous BOOLEAN NOT NULL DEFAULT 0,
    UNIQUE KEY(email)
) DEFAULT CHARSET=utf8;

CREATE TABLE Forums (
    id INT UNSIGNED AUTO_INCREMENT  NOT NULL PRIMARY KEY,
    name VARCHAR(40) UNIQUE KEY,
    short_name VARCHAR(40) UNIQUE KEY,
    user_id INT UNSIGNED,
    FOREIGN KEY (user_id) REFERENCES Users(id)
) DEFAULT CHARSET=utf8;

CREATE TABLE Threads (
    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    forum_id INT UNSIGNED NOT NULL,
    user_id INT UNSIGNED NOT NULL,
    title VARCHAR(50) NOT NULL,
    slug VARCHAR(50) NOT NULL,
    message TEXT NOT NULL,
    date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    likes INT NOT NULL DEFAULT 0,
    dislikes INT NOT NULL DEFAULT 0,
    isClosed BOOLEAN NOT NULL DEFAULT 0,
    isDeleted BOOLEAN NOT NULL DEFAULT 0,   
    FOREIGN KEY (user_id) REFERENCES Users(id), 
    FOREIGN KEY fo (forum_id) REFERENCES Forums(id)
) DEFAULT CHARSET=utf8;


CREATE TABLE  Posts (
    id INT UNSIGNED AUTO_INCREMENT NOT NULL PRIMARY KEY,
    user_id  INT UNSIGNED NOT NULL,
    message TEXT NOT NULL,
    forum_id INT UNSIGNED NOT NULL,
    thread_id INT UNSIGNED NOT NULL,
    parent INT NULL DEFAULT NULL,
    date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    likes INT NOT NULL DEFAULT 0,
    dislikes INT NOT NULL DEFAULT 0,
    isApproved BOOLEAN NOT NULL DEFAULT 0,
    isHighlighted BOOLEAN NOT NULL DEFAULT 0,
    isEdited BOOLEAN NOT NULL DEFAULT 0,
    isSpam BOOLEAN NOT NULL DEFAULT 0,
    isDeleted BOOLEAN NOT NULL DEFAULT 0,
    FOREIGN KEY (user_id) REFERENCES Users(id),
    FOREIGN KEY (thread_id) REFERENCES Threads(id),
    FOREIGN KEY (forum_id) REFERENCES Forums(id)
) DEFAULT CHARSET=utf8;


CREATE TABLE Followers (
    follower_id INT UNSIGNED NOT NULL,
    followee_id INT UNSIGNED  NOT NULL,
    UNIQUE (followee_id, follower_id)
) DEFAULT CHARSET=utf8;